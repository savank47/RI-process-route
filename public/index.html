<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Parts Production Tracker Pro</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üè≠</text></svg>">
    
    <!-- External Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/inspection.css">
</head>
<body class="bg-gray-50">
    <div class="pb-12">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-600 via-blue-600 to-cyan-500 text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold flex items-center gap-3">
                            <i class="fas fa-industry"></i>
                            Auto Parts Production Tracker <span class="bg-white/20 px-3 py-1 rounded-full text-sm">PRO</span>
                        </h1>
                        <p class="text-blue-100 mt-1">Master your processes, items, and production batches</p>
                    </div>
                    <div class="hidden md:block text-right">
                        <div class="flex items-center gap-2 justify-end mb-1">
                            <div id="apiStatus" class="api-status connecting"></div>
                            <span id="apiStatusText" class="text-sm text-blue-100">Connecting...</span>
                        </div>
                        <p class="text-sm text-blue-100"><i class="fas fa-clock mr-2"></i><span id="currentTime"></span></p>
                        <p class="text-xs text-blue-200 mt-1"><span id="todayDate"></span></p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Stats Bar -->
        <div class="bg-white border-b border-gray-200 shadow-sm">
            <div class="container mx-auto px-4 py-4 no-print">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="flex items-center gap-3 bg-indigo-50 rounded-lg p-3">
                        <div class="bg-indigo-600 text-white rounded-lg p-2">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div>
                            <p class="text-xs text-gray-600">Processes</p>
                            <p class="text-xl font-bold text-gray-800" id="statProcesses">0</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 bg-green-50 rounded-lg p-3">
                        <div class="bg-green-600 text-white rounded-lg p-2">
                            <i class="fas fa-box"></i>
                        </div>
                        <div>
                            <p class="text-xs text-gray-600">Items</p>
                            <p class="text-xl font-bold text-gray-800" id="statItems">0</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 bg-blue-50 rounded-lg p-3">
                        <div class="bg-blue-600 text-white rounded-lg p-2">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <div>
                            <p class="text-xs text-gray-600">Active Batches</p>
                            <p class="text-xl font-bold text-gray-800" id="statActiveBatches">0</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 bg-amber-50 rounded-lg p-3">
                        <div class="bg-amber-600 text-white rounded-lg p-2">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div>
                            <p class="text-xs text-gray-600">Completed</p>
                            <p class="text-xl font-bold text-gray-800" id="statCompletedBatches">0</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm">
            <div class="container mx-auto px-4">
                <div class="flex space-x-1 overflow-x-auto">
                    <button onclick="showTab('processes')" id="tab-processes" class="tab-active py-4 px-4 text-sm font-medium transition whitespace-nowrap">
                        <i class="fas fa-cogs mr-2"></i>Process Library
                    </button>
                    <button onclick="showTab('items')" id="tab-items" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                        <i class="fas fa-boxes mr-2"></i>Items Master
                    </button>
                    <button onclick="showTab('raw-materials')" id="tab-raw-materials" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                      <i class="fas fa-industry mr-2"></i>Raw Materials
                    </button>
                    <button onclick="showTab('batches')" id="tab-batches" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                        <i class="fas fa-layer-group mr-2"></i>Production Batches
                    </button>
                    <button onclick="showTab('tracking')" id="tab-tracking" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                        <i class="fas fa-tasks mr-2"></i>Batch Tracking
                    </button>
                    <button onclick="showTab('inspections')" id="tab-inspections" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                        <i class="fas fa-clipboard-check mr-2"></i>Inspection Reports
                    </button>
                    <button onclick="showTab('dashboard')" id="tab-dashboard" class="py-4 px-4 text-sm font-medium text-gray-600 hover:text-blue-600 transition whitespace-nowrap">
                        <i class="fas fa-chart-line mr-2"></i>Dashboard
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-8">
            
            <!-- PROCESS LIBRARY TAB -->
            <div id="content-processes" class="animate-slide-in">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-plus-circle mr-2 text-indigo-600"></i>Add New Process to Library</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="processName" placeholder="Process Name (e.g., CNC Machining)" class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                        <input type="text" id="processCode" placeholder="Process Code (e.g., CNC-01)" class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mt-4">
                        <input type="text" id="processDescription" placeholder="Description (e.g., CNC precision machining operation)" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Color Tag:</label>
                        <div class="flex gap-2 flex-wrap" id="colorPicker">
                            <button type="button" onclick="selectColor('gray')" class="color-btn w-8 h-8 rounded-full bg-gray-500 border-2 border-transparent hover:border-gray-800" data-color="gray"></button>
                            <button type="button" onclick="selectColor('red')" class="color-btn w-8 h-8 rounded-full bg-red-500 border-2 border-transparent hover:border-red-800" data-color="red"></button>
                            <button type="button" onclick="selectColor('orange')" class="color-btn w-8 h-8 rounded-full bg-orange-500 border-2 border-transparent hover:border-orange-800" data-color="orange"></button>
                            <button type="button" onclick="selectColor('amber')" class="color-btn w-8 h-8 rounded-full bg-amber-500 border-2 border-transparent hover:border-amber-800" data-color="amber"></button>
                            <button type="button" onclick="selectColor('green')" class="color-btn w-8 h-8 rounded-full bg-green-500 border-2 border-transparent hover:border-green-800" data-color="green"></button>
                            <button type="button" onclick="selectColor('teal')" class="color-btn w-8 h-8 rounded-full bg-teal-500 border-2 border-transparent hover:border-teal-800" data-color="teal"></button>
                            <button type="button" onclick="selectColor('blue')" class="color-btn w-8 h-8 rounded-full bg-blue-500 border-2 border-transparent hover:border-blue-800" data-color="blue"></button>
                            <button type="button" onclick="selectColor('indigo')" class="color-btn w-8 h-8 rounded-full bg-indigo-500 border-2 border-transparent hover:border-indigo-800" data-color="indigo"></button>
                            <button type="button" onclick="selectColor('purple')" class="color-btn w-8 h-8 rounded-full bg-purple-500 border-2 border-transparent hover:border-purple-800" data-color="purple"></button>
                            <button type="button" onclick="selectColor('pink')" class="color-btn w-8 h-8 rounded-full bg-pink-500 border-2 border-transparent hover:border-pink-800" data-color="pink"></button>
                        </div>
                    </div>
                    <div class="mt-4 flex gap-3">
                        <button onclick="addProcess()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-plus mr-2"></i>Add to Library
                        </button>
                        <button onclick="loadDefaultProcesses()" class="bg-gray-600 hover:bg-gray-700 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-magic mr-2"></i>Load Default Processes
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-list mr-2 text-indigo-600"></i>Process Library</h2>
                    <div id="processesList" class="flex flex-wrap gap-3"></div>
                </div>
            </div>

            <!-- ITEMS TAB -->
           <div id="content-items" class="hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-plus-circle mr-2 text-green-600"></i>Create New Item</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="itemName" placeholder="Item Name (e.g., Brake Disc)" class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500">
                        <input type="text" id="itemCode" placeholder="Item Code (e.g., BD-001)" class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500">
                        <input type="text" id="itemSpec" placeholder="Specifications" class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500">
                    </div>
            
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <select id="itemMaterialSelect" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 bg-white">
                                <option value="">-- Select Raw Material Link --</option>
                            </select>
                            <p class="text-[10px] text-gray-400 ml-1">Connects this item to weights in Raw Materials tab.</p>
                        </div>
                        <input type="text" id="itemCategory" placeholder="Category (e.g., Brakes, Engine)" class="border border-gray-300 rounded-lg px-4 py-[10px] focus:ring-2 focus:ring-green-500">
                    </div>
            
                    <div class="mt-6 p-4 bg-amber-50 rounded-lg border border-amber-200">
                        <h3 class="font-semibold text-gray-700 mb-3"><i class="fas fa-ruler-combined mr-2"></i>Define Dimensions with Tolerances</h3>
                        <div id="dimensionsContainer" class="space-y-3 mb-3"></div>
                        <button type="button" onclick="addDimensionRow()" class="bg-amber-600 hover:bg-amber-700 text-white px-4 py-2 rounded-lg text-sm transition">
                            <i class="fas fa-plus mr-2"></i>Add Dimension
                        </button>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="font-semibold text-gray-700 mb-3"><i class="fas fa-route mr-2"></i>Define Process Route for This Item</h3>
                        <div class="mb-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <h4 class="text-sm font-medium text-gray-700 mb-2">Available Processes (Click to Add):</h4>
                            <div id="availableProcessesForItem" class="flex flex-wrap gap-2"></div>
                        </div>
                        
                        <div class="p-4 bg-indigo-50 rounded-lg border-2 border-dashed border-indigo-200 drop-zone" id="processRouteZone">
                            <h4 class="text-sm font-medium text-gray-700 mb-2"><i class="fas fa-list-ol mr-2"></i>Process Route:</h4>
                            <div id="selectedProcessRoute" class="flex flex-wrap gap-2 min-h-[60px]"></div>
                        </div>
                    </div>
                    
                    <div class="mt-4 flex gap-3">
                        <button onclick="addItem()" class="bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-save mr-2"></i>Save Item
                        </button>
                        <button onclick="clearItemForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-times mr-2"></i>Clear Form
                        </button>
                    </div>
                </div>
            
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-boxes mr-2 text-green-600"></i>Items List</h2>
                    <div id="itemsList" class="space-y-4"></div>
                </div>
            </div>

            <!--RAW MATERIAL TAB  -->
            <div id="content-raw-materials" class="hidden animate-slide-in space-y-8"> <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center gap-3 mb-6 border-b border-gray-100 pb-4">
                    <div class="bg-indigo-100 text-indigo-600 p-2 rounded-lg">
                        <i class="fas fa-truck-loading"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800">Raw Material Master</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="space-y-1">
                        <label class="text-xs font-semibold text-gray-500 uppercase">Material Name</label>
                        <input type="text" id="rmName" placeholder="e.g. EN8 Round Bar" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-semibold text-gray-500 uppercase">Select Dealer</label>
                        <select id="rmDealerSelect" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                            <option value="">-- Select Dealer --</option>
                        </select>
                    </div>
                </div>
        
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="space-y-1">
                        <label class="text-xs font-semibold text-gray-500 uppercase">RM Dimension</label>
                        <input type="text" id="rmDimension" placeholder="e.g. 50mm Dia" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="space-y-1">
                            <label class="text-xs font-semibold text-gray-500 uppercase">Net Wt (kg)</label>
                            <input type="number" id="rmNetWeight" step="0.001" oninput="RawMaterialManager.calculateGrossWeight()" placeholder="0.500" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div class="space-y-1">
                            <label class="text-xs font-semibold text-gray-500 uppercase">Cutting Loss</label>
                            <select id="rmLossPercent" onchange="RawMaterialManager.calculateGrossWeight()" class="w-full border border-gray-300 rounded-lg px-2 py-3 focus:ring-2 focus:ring-indigo-500">
                                <option value="5">5%</option>
                                <option value="10" selected>10%</option>
                                <option value="15">15%</option>
                                <option value="20">20%</option>
                            </select>
                        </div>
                    </div>
                </div>
        
                <div class="bg-indigo-50 border border-indigo-100 rounded-lg p-4 mb-6 flex justify-between items-center">
                    <span class="text-indigo-700 font-medium">Calculated Gross Weight (inc. loss):</span>
                    <span class="text-2xl font-black text-indigo-700"><span id="rmGrossWeightDisplay">0.000</span> kg</span>
                </div>
        
                <button onclick="RawMaterialManager.save()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold px-8 py-3 rounded-lg shadow-lg transition-all active:transform active:scale-95">
                    <i class="fas fa-save mr-2"></i>Save to Master
                </button>
            </div>
        
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-amber-100 text-amber-600 p-2 rounded-lg">
                        <i class="fas fa-list"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800">Material Library</h2>
                </div>
                <div id="rmList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
            </div>
        
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 border-l-8 border-l-blue-600">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-blue-100 text-blue-600 p-2 rounded-lg">
                        <i class="fas fa-address-book"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800">Dealer Master</h2>
                </div>
                <div class="flex flex-col md:flex-row gap-4 mb-6">
                    <input type="text" id="dealerName" placeholder="Enter New Dealer Name" class="flex-1 border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500">
                    <button onclick="DealerManager.save()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-6 py-3 rounded-lg shadow-md whitespace-nowrap">
                        <i class="fas fa-plus mr-2"></i>Add Dealer
                    </button>
                </div>
                <div id="dealerList" class="flex flex-wrap gap-2">
                    </div>
            </div>
        
        </div>
            <!-- BATCHES TAB -->
            <div id="content-batches" class="hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-plus-circle mr-2 text-blue-600"></i>Create New Production Batch</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Batch Number:</label>
                            <input type="text" id="batchNumber" placeholder="e.g., BATCH-2024-001" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Quantity:</label>
                            <input type="number" id="batchQuantity" placeholder="e.g., 100" min="1" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Priority:</label>
                            <select id="batchPriority" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                                <option value="normal">Normal</option>
                                <option value="high">High Priority</option>
                                <option value="urgent">Urgent</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Target Date:</label>
                            <input type="date" id="batchTargetDate" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Select Item:</label>
                        <select id="batchItemSelect" onchange="previewBatchProcessRoute()" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                            <option value="">-- Select Item --</option>
                        </select>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">    
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Customer/Order Reference (Optional):</label>
                            <input type="text" id="batchCustomer" placeholder="e.g., Order #12345 or Customer Name" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                          <label class="block text-sm font-medium text-gray-700 mb-1">
                            Raw Material Batch No <span class="text-gray-400">(optional)</span>
                          </label>
                          <input
                            type="text"
                            id="batchRawMaterialBatch"
                            placeholder="e.g. RM-2401-H58"
                            class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500"
                          />
                        </div>
                    </div>

                    
                    <div id="processRoutePreview" class="mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 hidden">
                        <h4 class="font-semibold text-gray-800 mb-3"><i class="fas fa-route mr-2"></i>Process Route Preview:</h4>
                        <div id="routePreviewSteps" class="space-y-2"></div>
                    </div>
                    <div class="flex gap-4">
                        <button onclick="createBatch()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-play mr-2"></i>Create Batch
                        </button>
                        <button onclick="clearBatchForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                            <i class="fas fa-times mr-2"></i>Clear Form
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-gray-800"><i class="fas fa-layer-group mr-2 text-blue-600"></i>Production Batches</h2>
                        <select id="batchFilter" onchange="filterBatches()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                            <option value="all">All Batches</option>
                            <option value="active">Active Only</option>
                            <option value="completed">Completed Only</option>
                        </select>
                    </div>
                    <div id="batchesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </div>
            </div>

            <!-- TRACKING TAB -->
            <div id="content-tracking" class="hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-tasks mr-2 text-purple-600"></i>Track Batch Progress</h2>
                    <div class="mb-4 flex gap-3 items-end">
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Select Batch to Track:</label>
                            <select id="trackingBatchSelect" onchange="loadBatchTracking()" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500">
                                <option value="">-- Select Batch --</option>
                            </select>
                        </div>
                        <button type="button" onclick="generateInspectionReport()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg transition shadow-md whitespace-nowrap">
                            <i class="fas fa-clipboard-check mr-2"></i>Inspection Report
                        </button>
                    </div>
                    <div id="trackingDisplay" class="hidden">
                        <div class="mb-6 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg border border-purple-200">
                            <div id="batchInfo" class="font-semibold text-gray-800"></div>
                        </div>
                        
                        <!-- Progress Overview -->
                        <div class="mb-6">
                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                <span>Overall Progress</span>
                                <span id="overallProgressText">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div id="overallProgressBar" class="bg-gradient-to-r from-blue-500 to-green-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                            <h4 class="font-semibold text-gray-700 mb-2"><i class="fas fa-bolt mr-2"></i>Quick Actions:</h4>
                            <div class="flex gap-2 flex-wrap">
                                <button type="button" onclick="handleQuickAction(event, 'startNext')" class="px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg text-sm transition">
                                    <i class="fas fa-play mr-1"></i>Start Next Process
                                </button>
                                <button type="button" onclick="handleQuickAction(event, 'completeCurrent')" class="px-4 py-2 bg-green-100 hover:bg-green-200 text-green-800 rounded-lg text-sm transition">
                                    <i class="fas fa-check mr-1"></i>Complete Current
                                </button>
                                <button type="button" onclick="handleQuickAction(event, 'resetAll')" class="px-4 py-2 bg-amber-100 hover:bg-amber-200 text-amber-800 rounded-lg text-sm transition">
                                    <i class="fas fa-redo mr-1"></i>Reset All
                                </button>
                            </div>
                        </div>

                        <!-- Process Steps -->
                        <div id="processTracking" class="space-y-3"></div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-list-alt mr-2 text-purple-600"></i>All Batches Summary</h2>
                    <div id="batchSummary" class="space-y-3"></div>
                </div>
            </div>

            <!-- INSPECTION REPORTS TAB -->
            <div id="content-inspections" class="hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6 create-inspection-form inspection-form">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-clipboard-check mr-2 text-purple-600"></i>Create New Inspection Report</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Select Batch:</label>
                            <select id="inspectionBatchSelect" onchange="previewInspectionDimensions()" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500">
                                <option value="">-- Select Batch --</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Inspector Name:</label>
                            <input type="text" id="inspectorName" placeholder="Enter inspector name" class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Number of Samples:
                            </label>
                        
                            <select
                                class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500"
                                onchange="InspectionManager.setSampleSize(this.value)">
                                <option value="1">1 Sample</option>
                                <option value="2">2 Samples</option>
                                <option value="3">3 Samples</option>
                                <option value="5">5 Samples</option>
                                <option value="10">10 Samples</option>
                                <option value="custom">Custom‚Ä¶</option>
                            </select>
                        </div>
                        <!--Invoice Number and Date  -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                              Invoice Number <span class="text-gray-400">(optional)</span>
                            </label>
                            <input
                              type="text"
                              id="inspectionInvoiceNumber"
                              placeholder="e.g. INV-4587"
                              class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500"
                            />
                          </div>
                        
                          <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                              Invoice Date <span class="text-gray-400">(optional)</span>
                            </label>
                            <input
                              type="date"
                              id="inspectionInvoiceDate"
                              class="border border-gray-300 rounded-lg px-4 py-3 w-full focus:ring-2 focus:ring-purple-500"
                            />
                          </div>
                        </div>
                    </div>
                    
                    <div id="inspectionFormPreview" class="hidden">
                        <div class="mb-4 p-4 bg-purple-50 rounded-lg border border-purple-200">
                            <h4 class="font-semibold text-gray-800 mb-2"><i class="fas fa-info-circle mr-2"></i>Batch Information:</h4>
                            <div id="inspectionFormBatchInfo" class="text-sm text-gray-700"></div>
                        </div>
                        
                        <div class="mb-4">
                            <h4 class="font-semibold text-gray-800 mb-3"><i class="fas fa-ruler-combined mr-2"></i>Dimension Measurements:</h4>
                            <div id="inspectionFormDimensions" class="space-y-3"></div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Inspector Notes:</label>
                            <textarea id="inspectionFormNotes" rows="3" class="border border-gray-300 rounded-lg px-4 py-2 w-full" placeholder="Add observations, comments, or issues..."></textarea>
                        </div>
                        
                        <div class="flex gap-3">
                            <button onclick="saveInspectionFromTab()" class="bg-purple-600 hover:bg-purple-700 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                                <i class="fas fa-save mr-2"></i>Save Inspection Report
                            </button>
                            <button onclick="clearInspectionForm()" class="bg-gray-500 hover:bg-gray-600 text-white font-medium px-6 py-3 rounded-lg transition shadow-md">
                                <i class="fas fa-times mr-2"></i>Clear Form
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-4 inspection-reports-header">
                        <div class="flex gap-2">
                            <input type="text" 
                                   placeholder="Search RM Batch / Batch #..." 
                                   oninput="InspectionManager.filterByRMBatch(this.value)"
                                   class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-500">
                            
                            <select id="inspectionFilterBatch" onchange="filterInspectionReports()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <option value="all">All Batches</option>
                            </select>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800"><i class="fas fa-history mr-2 text-purple-600"></i>All Inspection Reports</h2>
                        <div class="flex gap-2">
                            <select id="inspectionFilterBatch" onchange="filterInspectionReports()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <option value="all">All Batches</option>
                            </select>
                            <select id="inspectionFilterStatus" onchange="filterInspectionReports()" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <option value="all">All Results</option>
                                <option value="approved">Approved Only</option>
                                <option value="rejected">Rejected Only</option>
                                <option value="conditional">Conditional Only</option>
                            </select>
                        </div>
                    </div>
                    <div id="inspectionReportsList" class="space-y-4"></div>
                </div>
            </div>

            <!-- DASHBOARD TAB -->
            <div id="content-dashboard" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-chart-pie mr-2 text-indigo-600"></i>Batch Status Overview</h2>
                        <div id="statusChart" class="flex items-center justify-center h-64"></div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-exclamation-triangle mr-2 text-amber-600"></i>Defect Report</h2>
                        <div id="defectReport" class="space-y-2"></div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-clock mr-2 text-blue-600"></i>Recent Activity</h2>
                    <div id="recentActivity" class="space-y-3"></div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4"><i class="fas fa-trophy mr-2 text-yellow-600"></i>Top Performing Items</h2>
                    <div id="topItems" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-6 mt-12">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-center md:text-left mb-4 md:mb-0">
                        <p class="font-semibold">Auto Parts Production Tracker Pro ¬© 2024</p>
                        <p class="text-xs text-gray-400 mt-1">Backend: Node.js + MongoDB | Deployed on Vercel</p>
                    </div>
                    <div class="flex gap-3 flex-wrap justify-center">
                        <button onclick="exportData()" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-lg transition">
                            <i class="fas fa-download mr-2"></i>Export Data
                        </button>
                        <button onclick="document.getElementById('importFile').click()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg transition">
                            <i class="fas fa-upload mr-2"></i>Import Data
                        </button>
                        <input type="file" id="importFile" accept=".json" onchange="importData(event)" class="hidden">
                    </div>
                </div>
            </div>
        </footer>

        <!-- Toast Notification -->
        <div id="toast" class="fixed bottom-4 right-4 transform translate-y-20 opacity-0 transition-all duration-300 z-50">
            <div class="bg-white rounded-lg shadow-xl p-4 flex items-center gap-3">
                <i id="toastIcon" class="fas fa-check-circle text-green-500 text-xl"></i>
                <div>
                    <p id="toastMessage" class="font-medium text-gray-800"></p>
                </div>
            </div>
        </div>

        <!-- Inspection Modal -->
        <div id="inspectionModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50 overflow-y-auto">
            <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 my-8">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-xl font-bold">Quality Inspection Report</h3>
                    <button onclick="closeInspectionModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div id="inspectionBatchInfo" class="mb-4"></div>
                
                <!-- Inspector Name Field -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Inspector Name: <span class="text-red-500">*</span></label>
                    <input type="text" id="modalInspectorName" placeholder="Enter your name" class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring-2 focus:ring-purple-500" required>
                </div>
                
                <div id="inspectionDimensions" class="space-y-4 mb-6 max-h-96 overflow-y-auto"></div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Inspector Notes:</label>
                    <textarea id="inspectorNotes" rows="3" class="border border-gray-300 rounded-lg px-4 py-2 w-full" placeholder="Add any observations or comments..."></textarea>
                </div>
                <div class="flex gap-3">
                    <button onclick="saveInspection()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-medium">
                        <i class="fas fa-save mr-2"></i>Save Inspection Report
                    </button>
                    <button onclick="closeInspectionModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Inspection History Modal -->
        <div id="inspectionHistoryModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50 overflow-y-auto">
            <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 my-8">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-xl font-bold">Inspection History</h3>
                    <button onclick="closeInspectionHistoryModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div id="inspectionHistoryList" class="space-y-4 max-h-96 overflow-y-auto"></div>
            </div>
        </div>
    </div>

    <!-- Modular JavaScript Files (Load in Order) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    
    <script src="js/dimensions.js"></script>
    <script src="js/inspection.js"></script>
    <script src="js/raw-materials.js"></script> 
    <script src="js/processes.js"></script>
    <script src="js/items.js"></script>
    <script src="js/batches.js"></script>
    <script src="js/tracking.js"></script>
    <script src="js/dashboard.js"></script>
    
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
